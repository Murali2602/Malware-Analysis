
## Introduction

We will be performing basic static analysis on the Malware_Unknown.exe.malz PE and also a Packed Malware. We will follow our methodology and try to gain as much info as possible.

##### Strings

You can either use the strings command or ***floss***.
Strings give u all of the output and even floss does but floss also gives u obfuscated strings.
![](https://i.imgur.com/MFU13o3.png)

We will store these now for future use.

```
+------------------------------------+
| FLOSS STATIC STRINGS: UTF-16LE (8) |
+------------------------------------+

jjjj
cmd.exe /C ping 1.1.1.1 -n 1 -w 3000 > Nul & Del /f /q "%s"
http://ssl-6582datamanager.helpdeskbros.local/favicon.ico
C:\Users\Public\Documents\CR433101.dat.exe
Mozilla/5.0
http://huskyhacks.dev
ping 1.1.1.1 -n 1 -w 3000 > Nul & C:\Users\Public\Documents\CR433101.dat.exe
open
```
Other sketchy strings - 
```
C:\Users\Matt\source\repos\HuskyHacks\PMAT-maldev\src\DownloadFromURL\Release\DownloadFromURL.pdb
```

##### PEVIEW -

This tool shows us metadata of the EXE file such as headers, imports, size etc. They contain valuable information such as whether it might be packed or not.

**Size (IMAGE_SECTION_HEADER .text)**- 
![](https://i.imgur.com/9CHtcjg.png)

**Note:**  *Virtual Size tells us how much space is allocated for a section during the loading process. The Size of Raw Data tells how big the section is on disk. These two values should usually be equal, because data should take up just as much space on the disk as it does in memory.*

As you can see from this screenshot the Virtual Size has hex code of **15A1** which is - **5537** in decimal and Size of Raw Data has hex code of **1600** which is - **5632** which is very close to Virtual size hence we can kind of tell that this is not a packed file and its not trying to obfuscate its size.

**IMAGE_NT_HEADERS (IMAGE_FILE_HEADER)** - 
This shows when the file was compiled.
![](https://i.imgur.com/9W77uUn.png)


**SECTION .rdata (IMPORT_Address_Table)** -

This contains the imports that the PE is performing and this can be a valuable indication. Like think about it, why would a calculator app need to import a Download function and download from a URL....clearly SKETCHY!! and hence we have to pay attention to these.
A good source to identify might-be-malicious imports - 
https://malapi.io

---
### Packed 

These are some of the features that scream this a packed file and by guess and googling we can figure out that ***upx*** is a packer and another main thing is the Virtual Size and Raw Data, you can see the Virtual Size has some bytes but the Raw data is 0.
![](https://i.imgur.com/Qz8yVA3.png)

**SECTION .rdata (IMPORT_Address_Table)** -

The Import table is going to be way smaller than expected as its packed and this is a strong indicator too.
![](https://i.imgur.com/T7A0cyd.png)

---
### PESTUDIO

This is like PEVIEW but much more feature rich and helpful for basic static analysis.
![](https://i.imgur.com/ijIuW3V.png)
You can take the hash and put it into Virustotal.
![](https://i.imgur.com/2eibWS6.png)
PESTUDIO gives us flagged imports and this can be helpful.

